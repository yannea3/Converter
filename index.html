<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Flour & Bread Helper</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 2rem;
      background-color: #fff8f0;
      color: #333;
      max-width: 600px;
    }

    h1 {
      font-size: 1.8rem;
      margin-bottom: 1.2rem;
      color: #5d3a00;
    }

    h2 {
      font-size: 1.4rem;
      margin-top: 2rem;
      color: #8a4b00;
    }

    input, select, button {
      padding: 0.5rem;
      margin: 0.3rem 0;
      font-size: 1rem;
      width: 100%;
      box-sizing: border-box;
    }

    button {
      background-color: #f4a261;
      color: white;
      border: none;
      cursor: pointer;
    }

    button:hover {
      background-color: #e76f51;
    }

    .result {
      background-color: #fff3e0;
      padding: 0.8rem;
      margin-top: 0.6rem;
      border-radius: 6px;
    }

    .section {
      margin-bottom: 2.5rem;
    }
  </style>
</head>
<body>
  <h1>Flour & Bread Helper</h1>

  <div class="section" id="converter-section">
    <h2>Unit Converter</h2>
    <label for="ingredient">Select Ingredient:</label>
    <select id="ingredient">
      <option value="flour">Flour</option>
      <option value="butter">Butter</option>
      <option value="sugar">Sugar</option>
      <option value="water">Water</option>
      <option value="shortening">Shortening</option>
      <option value="custom">Custom (input density)</option>
    </select>

    <label for="amount">Enter amount:</label>
    <input type="number" id="amount" placeholder="e.g. 1250" />

    <label for="unit">Unit:</label>
    <select id="unit">
      <option value="grams">Grams</option>
      <option value="ml">Milliliters</option>
    </select>

    <div id="custom-density-container" style="display: none;">
      <label for="custom-density">Enter custom density (g/ml):</label>
      <input type="number" step="0.01" id="custom-density" placeholder="e.g. 0.9" />
    </div>

    <button onclick="convert()">Convert</button>
    <div class="result" id="convert-result"></div>
  </div>

  <div class="section" id="scaler-section">
    <h2>Recipe Scaler</h2>
    <label for="newFlour">Enter flour amount (grams):</label>
    <input type="number" id="newFlour" placeholder="e.g. 400" />
    <button onclick="scaleRecipe()">Scale Recipe</button>
    <div class="result" id="scaled-recipe"></div>
  </div>

  <script>
    const densities = {
      flour: 0.128, // cups per gram
      butter: 0.0044,
      sugar: 0.005,
      water: 0.00423,
      shortening: 0.0044,
    };

    const fractionMap = {
      "0.125": "1/8",
      "0.25": "1/4",
      "0.333": "1/3",
      "0.5": "1/2",
      "0.667": "2/3",
      "0.75": "3/4",
      "0.875": "7/8"
    };

    function toFraction(decimal) {
      const rounded = Math.round(decimal * 8) / 8;
      const integer = Math.floor(rounded);
      const frac = (rounded - integer).toFixed(3);
      const fraction = fractionMap[frac] || "";
      return integer > 0
        ? (fraction ? `${integer} ${fraction}` : `${integer}`)
        : (fraction || "0");
    }

    function convert() {
      const ingredient = document.getElementById("ingredient").value;
      const amount = parseFloat(document.getElementById("amount").value);
      const unit = document.getElementById("unit").value;
      const resultEl = document.getElementById("convert-result");

      let density = densities[ingredient];
      if (ingredient === "custom") {
        density = parseFloat(document.getElementById("custom-density").value);
      }

      if (isNaN(amount) || isNaN(density) || density <= 0) {
        resultEl.innerText = "Please enter valid amount and density.";
        return;
      }

      let cups;
      if (unit === "grams") {
        cups = amount * density;
      } else {
        // ml
        cups = amount * density * 0.00423; // 1ml = 0.00423 cups
      }

      const decimalCups = cups.toFixed(2);
      const niceFraction = toFraction(cups);
      resultEl.innerText = `${decimalCups} or ${niceFraction} cup${cups >= 2 ? 's' : ''}`;
    }

    function scaleRecipe() {
      const flour = parseFloat(document.getElementById("newFlour").value);
      const result = document.getElementById("scaled-recipe");

      if (isNaN(flour) || flour <= 0) {
        result.innerText = "Please enter a valid amount of flour.";
        return;
      }

      const scale = flour / 11200;
      const sugar = 4200 * scale;
      const water = 11200 * scale;
      const shortening = 1500 * scale;
      const yeast = 225 * scale;
      const breadCount = Math.round(123 * (flour / 11200));

      result.innerHTML = `
        Adjusted ingredients for ${flour} grams flour:<br/>
        • Sugar: ${sugar.toFixed(1)}g<br/>
        • Water: ${water.toFixed(1)}ml<br/>
        • Shortening: ${shortening.toFixed(1)}g<br/>
        • Yeast: ${yeast.toFixed(1)}g<br/>
        • Estimated output: ~${breadCount} breads
      `;
    }

    document.getElementById("ingredient").addEventListener("change", function () {
      const show = this.value === "custom";
      document.getElementById("custom-density-container").style.display = show ? "block" : "none";
    });
  </script>
</body>
</html>
