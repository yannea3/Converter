<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Recipe Converter</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 600px;
      margin: auto;
      line-height: 1.6;
    }
    h2 {
      border-bottom: 2px solid #ddd;
      padding-bottom: 5px;
    }
    input, select {
      padding: 6px;
      margin: 5px 0;
      width: 100%;
      box-sizing: border-box;
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 10px;
    }
    .output {
      margin-top: 10px;
      background: #f4f4f4;
      padding: 10px;
    }
    .note {
      font-size: 0.9em;
      color: gray;
    }
  </style>
</head>
<body>

  <h2>üîÅ Unit Converter</h2>
  <label for="ingredient">Ingredient</label>
  <select id="ingredient">
    <option value="flour">Flour</option>
    <option value="sugar">Sugar</option>
    <option value="butter">Butter</option>
    <option value="water">Water</option>
    <option value="custom">Custom (enter density)</option>
  </select>

  <label for="customDensity">Custom Density (g/ml)</label>
  <input type="number" id="customDensity" placeholder="Only if custom ingredient" step="0.01" disabled>

  <label for="valueInput">Amount</label>
  <input type="number" id="valueInput" placeholder="Enter value" />

  <label for="fromUnit">From Unit</label>
  <select id="fromUnit">
    <option value="grams">Grams (g)</option>
    <option value="ml">Milliliters (ml)</option>
    <option value="cups">Cups</option>
    <option value="tbsp">Tablespoons</option>
    <option value="tsp">Teaspoons</option>
  </select>

  <label for="toUnit">To Unit</label>
  <select id="toUnit">
    <option value="grams">Grams (g)</option>
    <option value="ml">Milliliters (ml)</option>
    <option value="cups">Cups</option>
    <option value="tbsp">Tablespoons</option>
    <option value="tsp">Teaspoons</option>
  </select>

  <button onclick="convert()">Convert</button>

  <div class="output" id="convertResult"></div>

  <p class="note">Note: Cups may be shown as fractions for convenience.</p>

  <hr/>

  <h2>ü•ñ Recipe Scaler (Based on Flour)</h2>
  <label for="flour">Enter your flour amount (grams):</label>
  <input type="number" id="flour" value="400" />

  <button onclick="scaleRecipe()">Scale Recipe</button>

  <div class="output" id="recipeResult"></div>

  <script>
    const densities = {
      flour: 0.53,
      sugar: 0.85,
      butter: 0.96,
      water: 1,
    };

    const cupFractions = [
      [1, '1'],
      [0.75, '3/4'],
      [0.66, '2/3'],
      [0.5, '1/2'],
      [0.33, '1/3'],
      [0.25, '1/4']
    ];

    document.getElementById("ingredient").addEventListener("change", function () {
      const ingredient = this.value;
      const customDensityInput = document.getElementById("customDensity");
      customDensityInput.disabled = ingredient !== "custom";
    });

    function convert() {
      const val = parseFloat(document.getElementById("valueInput").value);
      const from = document.getElementById("fromUnit").value;
      const to = document.getElementById("toUnit").value;
      const ingredient = document.getElementById("ingredient").value;
      const customDensity = parseFloat(document.getElementById("customDensity").value);

      let density = densities[ingredient];
      if (ingredient === "custom") {
        if (isNaN(customDensity)) {
          alert("Please enter a custom density.");
          return;
        }
        density = customDensity;
      }

      if (isNaN(val) || isNaN(density)) {
        alert("Please fill in all fields.");
        return;
      }

      let grams;
      if (from === "grams") grams = val;
      else if (from === "ml") grams = val * density;
      else if (from === "cups") grams = val * 240 * density;
      else if (from === "tbsp") grams = val * 15 * density;
      else if (from === "tsp") grams = val * 5 * density;

      let result;
      if (to === "grams") result = grams;
      else if (to === "ml") result = grams / density;
      else if (to === "cups") result = grams / (240 * density);
      else if (to === "tbsp") result = grams / (15 * density);
      else if (to === "tsp") result = grams / (5 * density);

      let display = result.toFixed(2);
      if (to === "cups") {
        const closest = cupFractions.reduce((prev, curr) =>
          Math.abs(curr[0] - result) < Math.abs(prev[0] - result) ? curr : prev
        );
        display += ` (~${closest[1]} cup)`;
      }

      document.getElementById("convertResult").innerText = `Result: ${display} ${to}`;
    }

    function scaleRecipe() {
      const flour = parseFloat(document.getElementById("flour").value);
      if (isNaN(flour)) {
        alert("Please enter a valid flour amount.");
        return;
      }

      const ratio = flour / 2000;
      const yeast = 20 * ratio;
      const sugar = 400 * ratio;
      const salt = 24 * ratio;
      const water = 1120 * ratio;
      const shortening = 160 * ratio;
      const estimatedPieces = Math.round(123 * ratio);

      const result = `
        Yeast: ${yeast.toFixed(1)} g<br/>
        Sugar: ${sugar.toFixed(1)} g<br/>
        Salt: ${salt.toFixed(1)} g<br/>
        Water: ${water.toFixed(1)} ml<br/>
        Shortening: ${shortening.toFixed(1)} g<br/>
        <strong>Estimated Yield:</strong> ~${estimatedPieces} pieces
      `;
      document.getElementById("recipeResult").innerHTML = result;
    }
  </script>

</body>
</html>
